<%= simple_form_for @post do |f| %>
<%= f.input :date, as: :string, input_html: {class:'datepicker'} %>

<%= f.input :title %>
<%= f.association :horse, label: "Horse", input_html: {class:'dropdown'} %>
<%= f.input :body, as: :trix_editor %>
<%= f.simple_fields_for :post_images do |img| %>
  <%= render 'post_image_fields', f:img %>
  <% end %>
  <div class="links">
    <%= link_to_add_association 'add image', f, :post_images %>
  </div>
<%= f.association :categories, input_html: {class: "multiple"} %>
<%= f.submit "Add Session", class: "btn btn-primary" %>

<% end %>

<% currentdate = Time.now.strftime("%Y")%>


<script>

$(document).ready(function() {
let currentdate = moment().format('YYYY-MM-DD')
  $('.datepicker').flatpickr(
      {enableTime: true,
      defaultDate: currentdate // figure out how to make this for new only
    }
  );

  $('.multiple').select2();

  function formatHorse (horse) {
    if (!horse.id) {
      return horse.text;
    }

    console.log(horse);

    let $horse= $(
    `<span><img src="/uploads/horse/avatar_url/${horse.id}/thumb_horseavatar.jpg"/> ` +  horse.text  + `</span>`
   );

    return $horse;
  };

  $(".dropdown").select2({
    templateResult: formatHorse
  });
});
</script>
